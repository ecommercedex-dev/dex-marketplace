<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dex‚Ñ¢ ‚Äî Seller Registration</title>
    <link rel="icon" type="image/x-icon" href="../../DEX_FAVICON/favicon.png" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;700&family=Fredoka+One&display=swap"
      rel="stylesheet"
    />
    <style>
      /* === Reset & Base === */
      *,
      *::before,
      *::after {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      html,
      body {
        height: 100%;
      }
      body {
        font-family: "Quicksand", sans-serif;
        color: #fff;
        min-height: 100dvh;
        background: linear-gradient(rgba(40, 40, 20, 0.55), rgba(0, 0, 0, 0.7)),
          url("../Images/pexels-artempodrez-5025512.webp") center/cover
            no-repeat fixed;
        display: flex;
        flex-direction: column;
        -webkit-font-smoothing: antialiased;
      }

      /* === Header & Nav === */
      .main-header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 12px 20px;
        background: rgba(18, 18, 18, 0.35);
        backdrop-filter: blur(6px);
        z-index: 1200;
        transition: background 0.3s ease;
      }

      #company-name a {
        font-family: "Fredoka One", cursive;
        font-size: clamp(1.5rem, 5vw, 1.75rem);
        color: #fff;
        text-decoration: none;
      }

      .nav-list {
        display: flex;
        gap: 18px;
        list-style: none;
        align-items: center;
      }

      .nav-list a {
        color: #fff;
        text-decoration: none;
        padding: 8px 12px;
        border-radius: 8px;
        font-weight: 500;
        transition: all 0.25s ease;
      }

      .nav-list a:hover {
        background: #d4c247;
        color: #000;
      }

      /* === Mobile Menu Toggle === */
      .menu-toggle {
        display: none;
        background: none;
        border: none;
        color: #fff;
        font-size: 1.5rem;
        cursor: pointer;
        padding: 8px;
        border-radius: 6px;
      }

      .menu-toggle:hover {
        background: rgba(255, 255, 255, 0.1);
      }

      /* === Main Content === */
      main {
        flex: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 110px 20px 40px;
      }

      form {
        width: 100%;
        max-width: 560px;
        background: rgba(0, 0, 0, 0.56);
        padding: 30px;
        border-radius: 14px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.45);
        display: flex;
        flex-direction: column;
        gap: 14px;
        opacity: 0;
        transform: translateY(24px);
        animation: formIn 0.65s ease forwards;
      }

      @keyframes formIn {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      form h2 {
        color: #f5e371;
        font-size: 26px;
        text-align: center;
        margin-bottom: 6px;
      }

      form a {
        color: #d4c247;
        text-decoration: none;
      }

      form a:hover {
        text-decoration: underline;
        color: #f5e371;
      }

      /* === Input Group === */
      .input-group {
        position: relative;
        display: flex;
        gap: 10px;
        align-items: center;
      }

      .input-group i {
        color: #d4c247;
        min-width: 20px;
        animation: boldPulse 2.2s ease-in-out infinite;
      }

      .input-group input,
      .input-group select {
        background: rgba(0, 0, 0, 0.28);
        border: 1px solid #ccc;
        padding: 11px 14px;
        color: #fff;
        border-radius: 8px;
        width: 100%;
        font-size: 1rem;
        transition: all 0.25s ease;
      }

      .input-group input:focus,
      .input-group select:focus {
        outline: none;
        border-color: #f5e371;
        box-shadow: 0 6px 18px rgba(245, 227, 113, 0.08);
      }

      .peek {
        position: absolute;
        right: 12px;
        top: 50%;
        transform: translateY(-50%);
        cursor: pointer;
        color: #bbb;
        font-size: 18px;
        transition: color 0.2s;
      }

      .peek:hover {
        color: #fff;
      }

      /* === Checkbox === */
      .checkbox {
        display: flex;
        align-items: flex-start;
        gap: 8px;
        font-size: 14px;
        color: #ddd;
      }

      .checkbox input {
        margin-top: 2px;
      }

      /* === Button === */
      button {
        margin-top: 6px;
        padding: 12px;
        border-radius: 10px;
        border: 0;
        background: #d4c247;
        color: #000;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.25s ease-out;
      }

      button:hover {
        transform: translateY(-3px) scale(1.02);
      }

      button.loading {
        position: relative;
        color: transparent;
        pointer-events: none;
      }

      button.loading::after {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        width: 18px;
        height: 18px;
        margin: -9px 0 0 -9px;
        border: 3px solid #fff;
        border-top-color: #000;
        border-radius: 50%;
        animation: spin 0.8s linear infinite;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      /* === Footer === */
      footer {
        background: rgba(16, 16, 16, 0.35);
        text-align: center;
        padding: 14px 10px;
        color: #ddd;
        font-size: 0.9rem;
      }

      /* === Notifications === */
      .notification-container {
        position: fixed;
        top: 18px;
        right: 18px;
        display: flex;
        flex-direction: column;
        gap: 10px;
        z-index: 1500;
        pointer-events: none;
      }

      .notification {
        min-width: 240px;
        max-width: 360px;
        padding: 12px 14px;
        border-radius: 12px;
        display: flex;
        gap: 12px;
        align-items: center;
        background: rgba(255, 255, 255, 0.03);
        color: #fff;
        box-shadow: 0 8px 22px rgba(0, 0, 0, 0.45);
        opacity: 0;
        transform: translateX(18px);
        animation: notifIn 0.45s ease forwards, notifOut 0.6s ease 3.2s forwards;
        pointer-events: auto;
      }

      @keyframes notifIn {
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }
      @keyframes notifOut {
        to {
          opacity: 0;
          transform: translateX(18px);
        }
      }

      .notification.success {
        border: 1px solid #00c853;
      }
      .notification.error {
        border: 1px solid #ff5252;
      }

      /* === Overlay === */
      .overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.55);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 999;
      }

      .overlay.active {
        display: flex;
      }

      .overlay-box {
        background: white;
        color: black;
        padding: 25px;
        border-radius: 12px;
        text-align: center;
        max-width: 380px;
        animation: overlayPop 0.45s cubic-bezier(0.16, 0.8, 0.34, 1.35);
      }

      @keyframes overlayPop {
        0% {
          transform: scale(0.85);
          opacity: 0;
        }
        70% {
          transform: scale(1.04);
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }

      /* === Animations === */
      @keyframes boldBounce {
        0%,
        100% {
          transform: scale(1) translateY(0);
        }
        30% {
          transform: scale(1.25) translateY(-8px);
        }
        60% {
          transform: scale(0.95) translateY(4px);
        }
      }

      @keyframes boldPulse {
        0%,
        100% {
          transform: scale(1);
          opacity: 0.85;
        }
        50% {
          transform: scale(1.18);
          opacity: 1;
        }
      }

      .input-group:focus-within i,
      .input-group:hover i {
        animation: boldBounce 0.5s ease-out;
        color: #00ff9c;
        text-shadow: 0 0 12px #00ff9c;
      }

      .input-group:focus-within input,
      .input-group:focus-within select {
        border-color: #00ff9c;
        box-shadow: 0 0 15px rgba(0, 255, 156, 0.2);
      }

      /* === Responsive === */
      @media (max-width: 768px) {
        .menu-toggle {
          display: block;
        }

        .nav-list {
          display: none;
        }

        form {
          padding: 20px;
        }

        main {
          padding: 90px 15px 30px;
        }
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <header class="main-header">
      <div id="company-name">
        <a href="../../Dex-home.html">Dex‚Ñ¢</a>
      </div>
      <nav>
        <ul class="nav-list">
          <li><a href="../../Dex-home.html">Home</a></li>
          <li><a href="../../DEX_INFO/Dex-about.html">About</a></li>
          <li><a href="Sign_in.html">Buyer</a></li>
          <li><a href="seller_sign_in.html">Seller</a></li>
        </ul>
        <button class="menu-toggle" aria-label="Toggle menu">
          <i class="fas fa-bars"></i>
        </button>
      </nav>
    </header>

    <!-- Main Content -->
    <main>
      <form id="sellerForm">
        <!-- V1 Safety Banner -->
        <div
          style="
            background: linear-gradient(135deg, #00c853, #4caf50);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
            color: white;
            box-shadow: 0 4px 15px rgba(0, 200, 83, 0.3);
          "
        >
          <h3 style="margin: 0 0 10px 0; font-size: 1.2rem">
            üõ°Ô∏è DEX V1: Safety First Marketplace
          </h3>
          <p style="margin: 0; font-size: 0.9rem; opacity: 0.9">
            No payments ‚Ä¢ No carts ‚Ä¢ Just safe campus connections ‚Ä¢ Build your
            reputation through trust
          </p>
        </div>

        <!-- Seller Type Selection -->
        <div
          style="
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
          "
        >
          <h4 style="margin: 0 0 10px 0; color: #f5e371">
            Choose Your Seller Type:
          </h4>
          <div style="display: flex; gap: 10px; flex-wrap: wrap">
            <label
              style="
                display: flex;
                align-items: center;
                gap: 5px;
                cursor: pointer;
                padding: 8px 12px;
                background: rgba(0, 0, 0, 0.3);
                border-radius: 6px;
                border: 2px solid transparent;
                transition: all 0.3s;
              "
              onclick="selectSellerType('basic', this)"
            >
              <input
                type="radio"
                name="sellerType"
                value="basic"
                checked
                style="margin: 0"
              />
              <span>üè™ Basic Seller</span>
            </label>
            <label
              style="
                display: flex;
                align-items: center;
                gap: 5px;
                cursor: pointer;
                padding: 8px 12px;
                background: rgba(0, 0, 0, 0.3);
                border-radius: 6px;
                border: 2px solid transparent;
                transition: all 0.3s;
              "
              onclick="selectSellerType('campus', this)"
            >
              <input
                type="radio"
                name="sellerType"
                value="campus"
                style="margin: 0"
              />
              <span>üéì Campus Connected</span>
            </label>
            <label
              style="
                display: flex;
                align-items: center;
                gap: 5px;
                cursor: pointer;
                padding: 8px 12px;
                background: rgba(0, 0, 0, 0.3);
                border-radius: 6px;
                border: 2px solid transparent;
                transition: all 0.3s;
              "
              onclick="selectSellerType('business', this)"
            >
              <input
                type="radio"
                name="sellerType"
                value="business"
                style="margin: 0"
              />
              <span>üè¢ Business</span>
            </label>
          </div>
          <div
            id="sellerTypeInfo"
            style="margin-top: 10px; font-size: 0.85rem; color: #ddd"
          >
            Basic sellers get started immediately with phone & email
            verification.
          </div>
        </div>

        <h2>Seller Registration</h2>

        <div class="input-group">
          <i class="fas fa-user"></i>
          <input
            type="text"
            id="name"
            name="name"
            placeholder="Full Name"
            required
          />
        </div>

        <div class="input-group">
          <i class="fas fa-envelope"></i>
          <input
            type="email"
            id="email"
            name="email"
            placeholder="Email Address"
            required
          />
        </div>

        <div class="input-group">
          <i class="fas fa-phone"></i>
          <input
            type="tel"
            id="phone"
            name="phone"
            placeholder="Phone Number"
            pattern="[0-9+\s()\-]{10,15}"
            title="Enter a valid phone number (10-15 digits)"
            required
          />
        </div>

        <div class="input-group">
          <i class="fas fa-venus-mars"></i>
          <select id="gender" name="gender" required>
            <option value="">Select Gender</option>
            <option value="Male">Male</option>
            <option value="Female">Female</option>
            <option value="Other">Other</option>
          </select>
        </div>

        <div class="input-group">
          <i class="fas fa-store"></i>
          <input
            type="text"
            id="storeName"
            name="storeName"
            placeholder="Store Name"
            required
          />
        </div>

        <div class="input-group">
          <i class="fas fa-briefcase"></i>
          <select id="businessType" name="businessType" required>
            <option value="">Select Business Type</option>
            <option value="individual">Individual</option>
            <option value="boutique">Boutique</option>
            <option value="company">Company</option>
          </select>
        </div>

        <div class="input-group">
          <i class="fas fa-map-marker-alt"></i>
          <input
            type="text"
            id="businessAddress"
            name="businessAddress"
            placeholder="Business Address"
            required
          />
        </div>

        <div class="input-group">
          <i class="fas fa-box"></i>
          <select id="productCategory" name="productCategory" required>
            <option value="">Select Category</option>
            <option value="electronics">Electronics</option>
            <option value="fashion">Fashion</option>
            <option value="hostels">Hostels</option>
          </select>
        </div>

        <!-- V1: Payment info optional -->
        <div class="input-group" id="paymentGroup" style="display: none">
          <i class="fas fa-credit-card"></i>
          <input
            type="text"
            id="paymentInfo"
            name="paymentInfo"
            placeholder="Payment Info (Optional for V1)"
          />
        </div>

        <!-- Emergency Contact for Safety -->
        <div class="input-group">
          <i class="fas fa-phone-alt"></i>
          <input
            type="tel"
            id="emergencyContact"
            name="emergencyContact"
            placeholder="Emergency Contact (Required)"
            pattern="[0-9+\s()\-]{10,15}"
            title="Enter a valid emergency contact number (10-15 digits)"
            required
          />
        </div>

        <!-- Campus Connection (conditional) -->
        <div
          class="input-group"
          id="campusConnectionGroup"
          style="display: none"
        >
          <i class="fas fa-id-card"></i>
          <select id="campusConnection" name="campusConnection">
            <option value="">Select Campus Connection</option>
            <option value="student_id">Current Student (ID Required)</option>
            <option value="staff_id">Staff/Faculty (ID Required)</option>
            <option value="alumni">Alumni (Verification Required)</option>
            <option value="address_proof">Campus Address Proof</option>
          </select>
        </div>

        <div class="input-group">
          <i class="fas fa-lock"></i>
          <input
            type="password"
            id="password"
            name="password"
            placeholder="Password"
            required
          />
          <i class="fas fa-eye peek" onclick="togglePassword('password')"></i>
        </div>

        <div class="input-group">
          <i class="fas fa-lock"></i>
          <input
            type="password"
            id="confirmPassword"
            placeholder="Confirm Password"
            required
          />
          <i
            class="fas fa-eye peek"
            onclick="togglePassword('confirmPassword')"
          ></i>
        </div>

        <!-- V1 Safety Commitments -->
        <div class="checkbox">
          <input type="checkbox" id="safetyConfirmed" required />
          <label for="safetyConfirmed">
            ‚úÖ I will meet buyers only in safe, public campus areas during
            daylight
          </label>
        </div>

        <div class="checkbox">
          <input type="checkbox" id="antiScamConfirmed" required />
          <label for="antiScamConfirmed">
            ‚úÖ I will never request advance payments or personal banking details
          </label>
        </div>

        <div class="checkbox">
          <input type="checkbox" id="communityGuidelines" required />
          <label for="communityGuidelines">
            ‚úÖ I will maintain respectful communication and honest product
            descriptions
          </label>
        </div>

        <div class="checkbox">
          <input type="checkbox" id="reportingCommitment" required />
          <label for="reportingCommitment">
            ‚úÖ I will report suspicious activities to help keep our community
            safe
          </label>
        </div>

        <div class="checkbox">
          <input type="checkbox" id="terms" required />
          <label for="terms">
            I agree to the <a href="#">Terms of Service</a> and
            <a href="#">Privacy Policy</a>
          </label>
        </div>

        <button type="submit">Register as Seller</button>

        <p style="text-align: center; margin-top: 10px">
          Already have an account? <a href="seller_sign_in.html">Login here</a>
        </p>
      </form>
    </main>

    <!-- Footer -->
    <footer>
      <p>&copy; 2024 Dex‚Ñ¢. All rights reserved.</p>
    </footer>

    <!-- Notification Container -->
    <div class="notification-container"></div>

    <!-- Overlay -->
    <div class="overlay">
      <div class="overlay-box" style="max-width: 500px">
        <h3>üéâ Registration Successful!</h3>
        <p>Welcome to DEX V1 Marketplace!</p>
        <!-- Content will be dynamically updated by JavaScript -->
      </div>
    </div>

    <script>
      // Toggle password visibility
      function togglePassword(fieldId) {
        const field = document.getElementById(fieldId);
        const icon = field.nextElementSibling;

        if (field.type === "password") {
          field.type = "text";
          icon.classList.replace("fa-eye", "fa-eye-slash");
        } else {
          field.type = "password";
          icon.classList.replace("fa-eye-slash", "fa-eye");
        }
      }

      // Show notification
      function showNotification(message, type = "success") {
        const container = document.querySelector(".notification-container");
        const notification = document.createElement("div");
        notification.className = `notification ${type}`;
        notification.innerHTML = `
          <i class="fas ${
            type === "success" ? "fa-check-circle" : "fa-exclamation-circle"
          }"></i>
          <span>${message}</span>
        `;
        container.appendChild(notification);

        setTimeout(() => {
          notification.remove();
        }, 4000);
      }

      // Close overlay
      function closeOverlay() {
        document.querySelector(".overlay").classList.remove("active");
      }

      // Navigate to login page
      function goToLogin() {
        window.location.href = "seller_sign_in.html";
      }

      // Seller type selection
      function selectSellerType(type, element) {
        // Update UI
        document.querySelectorAll("label").forEach((label) => {
          label.style.border = "2px solid transparent";
        });
        element.style.border = "2px solid #00c853";

        // Show/hide conditional fields
        const campusGroup = document.getElementById("campusConnectionGroup");
        const paymentGroup = document.getElementById("paymentGroup");
        const infoDiv = document.getElementById("sellerTypeInfo");

        if (type === "basic") {
          campusGroup.style.display = "none";
          paymentGroup.style.display = "none";
          infoDiv.textContent =
            "Basic sellers get started immediately with phone & email verification.";
        } else if (type === "campus") {
          campusGroup.style.display = "flex";
          paymentGroup.style.display = "none";
          infoDiv.textContent =
            "Campus sellers get higher visibility with student/staff/alumni verification.";
        } else if (type === "business") {
          campusGroup.style.display = "none";
          paymentGroup.style.display = "flex";
          infoDiv.textContent =
            "Business sellers get premium features with business registration verification.";
        }
      }

      // Form submission with V1 validation
      document
        .getElementById("sellerForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const password = document.getElementById("password").value;
          const confirmPassword =
            document.getElementById("confirmPassword").value;
          const emergencyContact =
            document.getElementById("emergencyContact").value;

          // V1 Validation
          if (password !== confirmPassword) {
            showNotification("Passwords do not match!", "error");
            return;
          }

          if (password.length < 8) {
            showNotification(
              "Password must be at least 8 characters long!",
              "error"
            );
            return;
          }

          if (!emergencyContact.trim()) {
            showNotification(
              "Emergency contact is required for safety!",
              "error"
            );
            return;
          }

          // Check all safety commitments
          const requiredCheckboxes = [
            "safetyConfirmed",
            "antiScamConfirmed",
            "communityGuidelines",
            "reportingCommitment",
            "terms",
          ];
          for (const checkboxId of requiredCheckboxes) {
            if (!document.getElementById(checkboxId).checked) {
              showNotification(
                "Please accept all safety commitments and terms!",
                "error"
              );
              return;
            }
          }

          const formData = new FormData(this);
          const payload = Object.fromEntries(formData);

          // Add seller type
          payload.sellerType = document.querySelector(
            'input[name="sellerType"]:checked'
          ).value;

          const button = this.querySelector('button[type="submit"]');
          button.classList.add("loading");

          fetch("http://localhost:5000/api/sellers/register", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(payload),
          })
            .then((response) => response.json())
            .then((data) => {
              button.classList.remove("loading");
              if (data.message) {
                showNotification(data.message, "success");
                // Flag will be stored after email verification instead
                
                // Update overlay with verification guidance
                document.querySelector(".overlay-box").innerHTML = `
              <h3>üéâ Registration Successful!</h3>
              <p>Welcome to DEX V1! Your ${payload.sellerType} seller account is ready.</p>
              <div style="margin: 20px 0; padding: 15px; background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px; color: #856404;">
                <h4>‚ö†Ô∏è IMPORTANT - Before You Login:</h4>
                <ol style="text-align: left; margin: 10px 0; font-weight: bold;">
                  <li>üìß <strong>Check your email inbox</strong> (${payload.email})</li>
                  <li>üîó <strong>Click the verification link</strong> in the email</li>
                  <li>‚úÖ <strong>Only THEN come back to login</strong></li>
                </ol>
                <div style="background: #f8d7da; border: 1px solid #f5c6cb; padding: 10px; border-radius: 4px; margin-top: 10px; color: #721c24;">
                  <strong>üö´ If you try to login WITHOUT clicking the email link first, you'll get a "verify email" error!</strong>
                </div>
              </div>
              <button onclick="window.open('https://mail.google.com', '_blank')" style="background: #1a73e8; color: white; border: none; padding: 12px 24px; border-radius: 6px; cursor: pointer; margin: 5px;">üìß Open Gmail</button>
              <button onclick="closeOverlay()" style="background: #ddd; color: #333; border: none; padding: 12px 24px; border-radius: 6px; cursor: pointer; margin: 5px;">I'll Check Email</button>
            `;
                document.querySelector(".overlay").classList.add("active");
                this.reset();
              } else {
                showNotification(
                  data.message || "Registration failed",
                  "error"
                );
              }
            })
            .catch((error) => {
              button.classList.remove("loading");
              showNotification(
                "Registration failed. Please try again.",
                "error"
              );
              console.error("Error:", error);
            });
        });
    </script>
  </body>
</html>
